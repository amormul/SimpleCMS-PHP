<?php
/**
 * AuthMiddleware - Класс для проверки аутентификации и прав доступа пользователя.
 */
class AuthMiddleware {

    /**
     * Проверка, что пользователь авторизован.
     * Если пользователь не авторизован, перенаправляет на страницу входа.
     */
    public static function requireAuth() {
        // Если ID пользователя в сессии не существует (не авторизован)
        if (!isset($_SESSION['user_id'])) {
            // Перенаправляем на страницу входа
            header('Location: /auth/login');
            exit; // Прерываем выполнение кода
        }
    }

    /**
     * Проверка, что пользователь не авторизован.
     * Если пользователь уже авторизован, перенаправляет на главную страницу.
     */
    public static function requireGuest() {
        // Если ID пользователя в сессии существует (пользователь авторизован)
        if (isset($_SESSION['user_id'])) {
            // Перенаправляем на страницу администратора
            header('Location: /admin/dashboard');
            exit; // Прерываем выполнение кода
        }
    }
}